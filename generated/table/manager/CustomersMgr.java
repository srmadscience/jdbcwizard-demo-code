package com.orindasoft.demo.generated.table.manager;

import java.sql.*; 
import com.orindasoft.pub.LogInterface; 
import com.orindasoft.pub.OracleResourceUser; 
import com.orindasoft.pub.CSException; 
import com.orindasoft.pub.CSColumnException; 

import com.orindasoft.demo.generated.table.instance.*;

/** 
* Manager Class for CustomersRow
* 
* <p>Generated by JDBCWizard build 2814 at 2011/11/22 00:33:39.339 GMT
* <p>JDBCWizard is made by <a href="http://www.orindasoft.com/?pdsrc=GD2814" target="_blank">Orinda Software Ltd, Dublin, Ireland</a>
* <p>Target Database: Oracle 10.2.0
* <p> -------------------------------------------------------------------------
* <p> WARNING: This code will stop working around the time JDBCWizard expires.
* <p> This restriction only exists in the demo version of JDBCWizard.
* <p> -------------------------------------------------------------------------
* <p> JDBCWizard Tips 7 of 19:
* <p> JDBCWizard can run stored procedures with Oracle VARRAYS as parameters
* <p> -------------------------------------------------------------------------
* 
* <p>Copyright Orinda Software 2003-2009
* @author devteam60@orindabuild.com
* @version 1.1
*/ 
public class CustomersMgr extends AbstractTableMgr implements OracleResourceUser
{ 
  /**                                             
  * Properties object to keep track of ORDER BYs
  * 
  */                                              
  java.util.Properties orderByProperties = null;
  
  /**                                             
  * Class To Retrieve 1 Record By Primary Key Lookup
  * 
  */                                              
  CustomersConCstPk theCustomersCstPk = null;
  
  /**                                             
  * Class To Retrieve 1 or More Records Using Index CST_IX1 
  * 
  */                                              
  CustomersConCstIx1 theCustomersCstIx1 = null;
  
  /**                                             
  * Class To Lock A Row For Update 
  * 
  */                                              
  CustomersLckCstPk theCustomersCstPkLck = null;
  
  /**                                             
  * Class To Insert A Row 
  * 
  */                                              
  CustomersIns theCustomersIns = null;
  
  /**                                             
  * Class To Update A Row 
  * 
  */                                              
  CustomersUpd CustomersUpd = null;
  
  /**                                             
  * Class To Delete A Row 
  * 
  */                                              
  CustomersDel theCustomersDel = null;
  
  /**                                             
  * Class To Retrieve Rows from ORINDADEMO.BOOKINGS Using Foreign Key BKG_CST
  * 
  */                                              
  public BookingsConBkgCst theBookingsBkgCst = null;
   
  /**                                             
  * Constructor 
  * @since 4.0.1906 Support for dynamic ORDER BYs
  * 
  */                                              
  public CustomersMgr(Connection theConnection, LogInterface theLog) 
    { 
    super(theConnection, theLog);
    theLog.debug("CustomersMgr - Started");
     
    //Populate list of ORDER BY clauses
    orderByProperties = new java.util.Properties();
    orderByProperties.put("CustomersConCstIx1", CustomersConCstIx1.DEFAULT_ORDER_BY);
    orderByProperties.put("BookingsConBkgCst", BookingsConBkgCst.DEFAULT_ORDER_BY);
    } 
    
  /**                                             
  * Set ORDER BY clause for class CustomersConCstIx1
  * @param String newOrderBy The new ORDER BY clause
  * @since 4.0.1905
  * 
  */                                              
  public void setOrderByForCstIx1( String newOrderBy)  
    { 
    orderByProperties.put("CustomersConCstIx1", newOrderBy);
     
    if (theCustomersCstIx1 != null)
      {
      theCustomersCstIx1.setOrderBy(newOrderBy);
      }
    }
   
  /**                                             
  * Set ORDER BY clause for class BookingsConBkgCst
  * @param String newOrderBy The new ORDER BY clause
  * @since 4.0.1905
  * 
  */                                              
  public void setOrderByForBookingsConBkgCst( String newOrderBy)  
    { 
    orderByProperties.put("BookingsConBkgCst", newOrderBy);
     
    if (theBookingsBkgCst != null)
      {
      theBookingsBkgCst.setOrderBy(newOrderBy);
      }
    }
   
  /**                                             
  * Validate a CustomersRow
  * @param CustomersRow theRow The row to be validated
  * @throws CSColumnException When the row has a missing NOT NULL column
  * @throws CSColumnException When the row has a field that won't fit into its database column
  * @since 4.0.1709
  * 
  */                                              
  public void rowValidate( CustomersRow theRow) throws CSColumnException 
    { 
    theLog.debug("Validating Row");
     
    // Column rowName can not be null or a zero length string
    if (theRow.rowName == null || theRow.rowName.length() == 0)
      {
      throw new CSColumnException("CUSTOMERS","NAME",CSColumnException.NULL_NOT_ALLOWED_HERE,theRow.rowName,false,80,0,"CUSTOMERS.NAME can't be NULL");
      }
      
    // Column rowName can not be more than 80 characters
    if (theRow.rowName != null && theRow.rowName.length() > 80 )
      {
      throw new CSColumnException("CUSTOMERS","NAME",CSColumnException.COLUMN_LENGTH_EXCEEDED,theRow.rowName,false,80,0,"CUSTOMERS.NAME is too big");
      }
      
    // Column rowAddress can not be more than 50 characters
    if (theRow.rowAddress != null && theRow.rowAddress.length() > 50 )
      {
      throw new CSColumnException("CUSTOMERS","ADDRESS",CSColumnException.COLUMN_LENGTH_EXCEEDED,theRow.rowAddress,true,50,0,"CUSTOMERS.ADDRESS is too big");
      }
      
    // Column rowCity can not be more than 50 characters
    if (theRow.rowCity != null && theRow.rowCity.length() > 50 )
      {
      throw new CSColumnException("CUSTOMERS","CITY",CSColumnException.COLUMN_LENGTH_EXCEEDED,theRow.rowCity,true,50,0,"CUSTOMERS.CITY is too big");
      }
      
    // Column rowState can not be more than 2 characters
    if (theRow.rowState != null && theRow.rowState.length() > 2 )
      {
      throw new CSColumnException("CUSTOMERS","STATE",CSColumnException.COLUMN_LENGTH_EXCEEDED,theRow.rowState,true,2,0,"CUSTOMERS.STATE is too big");
      }
      
    // Column rowZip can not be more than 5 digits
    if (theRow.rowZip != null && theRow.rowZip.abs().doubleValue() > 99999 )
      {
      throw new CSColumnException("CUSTOMERS","ZIP",CSColumnException.COLUMN_LENGTH_EXCEEDED,theRow.rowZip,true,5,0,"CUSTOMERS.ZIP is too big");
      }
      
    // Column rowZip can not have decimal places. 
    if (theRow.rowZip != null && theRow.rowZip.doubleValue() !=  theRow.rowZip.longValue() )
      {
      throw new CSColumnException("CUSTOMERS","ZIP",CSColumnException.DECIMAL_PLACES_EXCEEDED,theRow.rowZip,true,5,0,"CUSTOMERS.ZIP has too many decimal places");
      }
      
    // Column rowPhone can not be more than 12 characters
    if (theRow.rowPhone != null && theRow.rowPhone.length() > 12 )
      {
      throw new CSColumnException("CUSTOMERS","PHONE",CSColumnException.COLUMN_LENGTH_EXCEEDED,theRow.rowPhone,true,12,0,"CUSTOMERS.PHONE is too big");
      }
      
    } 
    
  /**                                             
  * Class To Retrieve 1 Record By Primary Key Lookup
  * @param String paramName CUSTOMERS.NAME
  * @return CustomersRow
  * @return null if no record found
  * @throws CSException
  */                                              
  public CustomersRow getByPk(String paramName) throws CSException
    {
    theLog.debug("getByPk - Called"); //DEBUG
    CustomersRow returnedRows = null;
    
    if (theCustomersCstPk ==  null)
      {
      theCustomersCstPk = new CustomersConCstPk(theConnection, theLog); 
      theCustomersCstPk.setKeepLobs(true);
      }
    
    theCustomersCstPk.setParamName(paramName);
    returnedRows = processOneCustomersRow(theCustomersCstPk.executeQuery());
    
    return(returnedRows);
    }
  
  /**                                             
  * Class To Retrieve 1 Record By Primary Key Lookup
  * @param CustomersRow theRow
  * @return CustomersRow
  * @return null if no record found
  * @throws CSException
  */                                              
  public CustomersRow getByPk(CustomersRow theRow) throws CSException
    {
    
    return(getByPk(theRow.rowName));
    }
  
  /**                                             
  * Insert A Row
  * @param CustomersRow theRow
  * @return CustomersRow
  * @throws CSException
  */                                              
  public CustomersRow rowInsert(CustomersRow theRow) throws CSException
    {
    theLog.debug("rowInsert - Called"); //DEBUG
    
    // Check that NOT NULL fields are filled in and field sizes match database columns
    // A CSColumnException will be thrown if somnething is wrong.
    rowValidate(theRow);
     
    if (theCustomersIns ==  null)
      {
      theCustomersIns = new CustomersIns(theConnection, theLog); 
      }
    
    CustomersConCstPk theCustomersCstPk = null;
    theCustomersIns.setParamName(theRow.rowName);
    theCustomersIns.setParamAddress(theRow.rowAddress);
    theCustomersIns.setParamCity(theRow.rowCity);
    theCustomersIns.setParamState(theRow.rowState);
    theCustomersIns.setParamZip(theRow.rowZip);
    theCustomersIns.setParamBirthdate(theRow.rowBirthdate);
    theCustomersIns.setParamPhone(theRow.rowPhone);
    
    theCustomersIns.executeCall();
    
    
    return(theRow);
    }
  
  /**                                             
  * Update A Row
  * @param CustomersRow theRow
  * @return CustomersRow
  * @throws CSException
  */                                              
  public CustomersRow rowUpdate(CustomersRow theRow) throws CSException
    {
    // Update row without obtaining low level lock first
    return(rowUpdate(theRow, false));
    }
     
  /**                                             
  * Update A Row
  * @param CustomersRow theRow
  * @param boolean lockRowFirst
  * @return CustomersRow
  * @throws CSException
  */                                              
  public CustomersRow rowUpdate(CustomersRow theRow, boolean lockRowFirst) throws CSException
    {
    theLog.debug("rowUpdate - Called"); //DEBUG
    CustomersRow returnedRow = null;
    
    // Check that NOT NULL fields are filled in and field sizes match database columns
    // A CSColumnException will be thrown if somnething is wrong.
    rowValidate(theRow);
     
    if (CustomersUpd ==  null)
      {
      CustomersUpd = new CustomersUpd(theConnection, theLog); 
      }
    
    
    if (lockRowFirst)
      {
      rowLock(theRow);
      }
    
    CustomersUpd.setParamName(theRow.rowName);
    CustomersUpd.setParamAddress(theRow.rowAddress);
    CustomersUpd.setParamCity(theRow.rowCity);
    CustomersUpd.setParamState(theRow.rowState);
    CustomersUpd.setParamZip(theRow.rowZip);
    CustomersUpd.setParamBirthdate(theRow.rowBirthdate);
    CustomersUpd.setParamPhone(theRow.rowPhone);
    CustomersUpd.executeCall();
    
    returnedRow = theRow;
    
    return(returnedRow);
    }
  
  /**                                             
  * Delete A Row
  * @param CustomersRow theRow
  * @throws CSException
  */                                              
  public void rowDelete(CustomersRow theRow) throws CSException
    {
    theLog.debug("rowDelete - Called"); //DEBUG
    if (theCustomersDel ==  null)
      {
      theCustomersDel = new CustomersDel(theConnection, theLog); 
      }
    
    theCustomersDel.setParamName(theRow.rowName);
    theCustomersDel.executeCall();
    
    }
  
  /**                                             
  * Retrieve Rows from ORINDADEMO.BOOKINGS Using Foreign Key BKG_CST
  * @param CustomersRow theRow
  * @return BookingsRow[]
  * @throws CSException
  */                                              
  public BookingsRow[] getChildByFkBkgCst(CustomersRow theRow) throws CSException
    {
    
    BookingsRow[] returnedRows = null;
    
    if (theBookingsBkgCst ==  null)
      {
      theBookingsBkgCst = new BookingsConBkgCst(theConnection, orderByProperties.getProperty("BookingsConBkgCst"), theLog); 
      theBookingsBkgCst.setKeepLobs(true);
      }
     
    theBookingsBkgCst.setParamCustomerName(theRow.rowName);
     
    returnedRows = processManyBookingsRows(theBookingsBkgCst.executeQuery(), Integer.MAX_VALUE);
     
    return(returnedRows);
    }
   
  /**                                             
  * Class To Retrieve 1 or More Records Using Index CST_IX1 
  * @param String paramState CUSTOMERS.STATE
  * @return CustomersRow[]
  * @return a null array of CustomersRow if no record found
  * @throws CSException
  */                                              
  public CustomersRow[] getChildByIxCstIx1(String paramState) throws CSException
    {
    theLog.debug("getChildByIxCstIx1 - Called"); //DEBUG
    CustomersRow[] returnedRows = null;
    
    if (theCustomersCstIx1 ==  null)
      {
      theCustomersCstIx1 = new CustomersConCstIx1(theConnection, orderByProperties.getProperty("CustomersConCstIx1"),theLog); 
      theCustomersCstIx1.setKeepLobs(true);
      }
    
    theCustomersCstIx1.setParamState(paramState);
    returnedRows = processManyCustomersRows(theCustomersCstIx1.executeQuery(), Integer.MAX_VALUE);
    
    return(returnedRows);
    }
  
  /**                                             
  * Lock Record For Update
  * @param String paramName CUSTOMERS.NAME
  * @return CustomersRow
  * @return null if no record found
  * @throws CSException
  */                                              
  public CustomersRow rowLock(String paramName) throws CSException
    {
    theLog.debug("rowLock - Called"); //DEBUG
    CustomersRow returnedRows = null;
    
    if (theCustomersCstPkLck ==  null)
      {
      
      // Row Level locking won't work if we are in autocommit mode
      boolean autoCommitMode = true;
      try
        {
        autoCommitMode = theConnection.getAutoCommit();
        }
      catch (SQLException e)
        {
        throw new CSException(e.getMessage());
        }
      
      if (autoCommitMode)
        {
        throw (new CSException("lockRow method can't work if Connection's autoCommit property is set to 'true'"));
        }
      
      theCustomersCstPkLck = new CustomersLckCstPk(theConnection, theLog); 
      theCustomersCstPkLck.setKeepLobs(true);
      }
    
    theCustomersCstPkLck.setParamName(paramName);
    returnedRows = processOneCustomersRow(theCustomersCstPkLck.executeQuery());
    
    return(returnedRows);
    }
  
  /**                                             
  * Lock Record For Update
  * @param CustomersRow theRow
  * @return CustomersRow
  * @return null if no record found
  * @throws CSException
  */                                              
  public CustomersRow rowLock(CustomersRow theRow) throws CSException
    {
    
    return(rowLock(theRow.rowName));
    }
  
/**
* Create a single CustomersRow from a com.orindasoft.pub.ReadOnlyRowSet
* @param com.orindasoft.pub.ReadOnlyRowSet theRowSet - A ReadOnlyRowSet that is a row from ORINDADEMO.CUSTOMERS
* @return CustomersRow
**/
public CustomersRow processOneCustomersRow(com.orindasoft.pub.ReadOnlyRowSet theRowSet) throws CSException
  {
  CustomersRow new_record = null;

  if (theRowSet.size() > 0)
    {
    new_record = new CustomersRow();
    theRowSet.first();
    Object[] theArray = theRowSet.getCurrentRow();

    new_record.setRowName((String)theArray[0]);
   
    if (theArray[1] != null)
      {
      new_record.setRowAddress((String)theArray[1]);
      }
   
    if (theArray[2] != null)
      {
      new_record.setRowCity((String)theArray[2]);
      }
   
    if (theArray[3] != null)
      {
      new_record.setRowState((String)theArray[3]);
      }
   
    if (theArray[4] != null)
      {
      new_record.setRowZip((java.math.BigDecimal)theArray[4]);
      }
   
    if (theArray[5] != null)
      {
      new_record.setRowBirthdate((java.util.Date)theArray[5]);
      }
   
    if (theArray[6] != null)
      {
      new_record.setRowPhone((String)theArray[6]);
      }
    }

  return(new_record);
  }

/**
* Create an arbitrary number of CustomersRow from a com.orindasoft.pub.ReadOnlyRowSet
* @param com.orindasoft.pub.ReadOnlyRowSet theRowSet
* @return CustomersRow[]
**/
public CustomersRow[] processManyCustomersRows(com.orindasoft.pub.ReadOnlyRowSet theRowSet, int howMany) throws CSException
  {
  // Limit size of array if requested...
  int size = theRowSet.size();
  if (howMany < size)
    {
    size = howMany;
    }

  CustomersRow[] new_rows = null;
  CustomersRow new_record = null;

  // Only initialize array if ReadOnlyRowSet has data...
  if (size > 0)
    {
    new_rows =  new CustomersRow[size];
    }

  // Loop through ReadOnlyRowSet and populate our array
  for (int i=0; i < size; i++)
    {
    theRowSet.setCurrentRowNumber(i);
    new_record = new CustomersRow();
    Object[] theArray = theRowSet.getCurrentRow();

    new_record.setRowName((String)theArray[0]);
   
    if (theArray[1] != null)
      {
      new_record.setRowAddress((String)theArray[1]);
      }
   
    if (theArray[2] != null)
      {
      new_record.setRowCity((String)theArray[2]);
      }
   
    if (theArray[3] != null)
      {
      new_record.setRowState((String)theArray[3]);
      }
   
    if (theArray[4] != null)
      {
      new_record.setRowZip((java.math.BigDecimal)theArray[4]);
      }
   
    if (theArray[5] != null)
      {
      new_record.setRowBirthdate((java.util.Date)theArray[5]);
      }
   
    if (theArray[6] != null)
      {
      new_record.setRowPhone((String)theArray[6]);
      }

    new_rows[i] = new_record;
    }

  return(new_rows);
  }
/**
* Create a single BookingsRow from a com.orindasoft.pub.ReadOnlyRowSet
* @param com.orindasoft.pub.ReadOnlyRowSet theRowSet - A ReadOnlyRowSet that is a row from ORINDADEMO.BOOKINGS
* @return BookingsRow
**/
public BookingsRow processOneBookingsRow(com.orindasoft.pub.ReadOnlyRowSet theRowSet) throws CSException
  {
  BookingsRow new_record = null;

  if (theRowSet.size() > 0)
    {
    new_record = new BookingsRow();
    theRowSet.first();
    Object[] theArray = theRowSet.getCurrentRow();

    new_record.setRowCustomerName((String)theArray[0]);
    new_record.setRowAirlineName((String)theArray[1]);
    new_record.setRowFlightNumber((java.math.BigDecimal)theArray[2]);
    new_record.setRowDepartureTime((java.util.Date)theArray[3]);
    new_record.setRowSeat((String)theArray[4]);
    }

  return(new_record);
  }

/**
* Create an arbitrary number of BookingsRow from a com.orindasoft.pub.ReadOnlyRowSet
* @param com.orindasoft.pub.ReadOnlyRowSet theRowSet
* @return BookingsRow[]
**/
public BookingsRow[] processManyBookingsRows(com.orindasoft.pub.ReadOnlyRowSet theRowSet, int howMany) throws CSException
  {
  // Limit size of array if requested...
  int size = theRowSet.size();
  if (howMany < size)
    {
    size = howMany;
    }

  BookingsRow[] new_rows = null;
  BookingsRow new_record = null;

  // Only initialize array if ReadOnlyRowSet has data...
  if (size > 0)
    {
    new_rows =  new BookingsRow[size];
    }

  // Loop through ReadOnlyRowSet and populate our array
  for (int i=0; i < size; i++)
    {
    theRowSet.setCurrentRowNumber(i);
    new_record = new BookingsRow();
    Object[] theArray = theRowSet.getCurrentRow();

    new_record.setRowCustomerName((String)theArray[0]);
    new_record.setRowAirlineName((String)theArray[1]);
    new_record.setRowFlightNumber((java.math.BigDecimal)theArray[2]);
    new_record.setRowDepartureTime((java.util.Date)theArray[3]);
    new_record.setRowSeat((String)theArray[4]);

    new_rows[i] = new_record;
    }

  return(new_rows);
  }
   
  /** 
  * Release all Oracle db resources that we know to be in use. 
  *  @return boolean <code>true</code> if we didn't encounter any problems, otherwise <code>false</code> 
  */ 
   
  public boolean releaseResources() 
    { 
    boolean returnCode = true; 
    
    theLog.debug("CustomersMgr - Attempting to release connection");
    try 
      { 
      
      if (theCustomersIns != null)
        { 
        theCustomersIns.releaseResources(); 
        } 
      
      if (CustomersUpd != null)
        { 
        CustomersUpd.releaseResources(); 
        } 
      
      if (theCustomersDel != null)
        { 
        theCustomersDel.releaseResources(); 
        } 
      
      if (theBookingsBkgCst != null)
        { 
        theBookingsBkgCst.releaseResources(); 
        } 
      
      if (theCustomersCstPkLck != null)
        { 
        theCustomersCstPkLck.releaseResources(); 
        } 
      
      if (theCustomersCstPk != null)
        { 
        theCustomersCstPk.releaseResources(); 
        } 
      
      if (theCustomersCstIx1 != null)
        { 
        theCustomersCstIx1.releaseResources(); 
        } 
      } 
    catch (Exception e) 
      { 
      theLog.warning(e.toString()); 
      returnCode = false; 
      } 
    
    theConnection = null; 
    theLog.debug("CustomersMgr- Finished releasing connection");
    
    return(returnCode); 
    } 
  
  /** 
  * Check to see if we are using Oracle Resources
  * @return <code>true</code> if we are using resources
  * @return <code>false</code> if we are not using resources
  */ 
  public boolean hasResources() 
    { 
    if (theConnection == null) 
      { 
      return (false); 
      } 
    
    return(true); 
    } 
   
  /** 
  * Give all classes that have been instantiated a new database connection 
  * This undoes the effects of releaseResources
  * @param Connection theConnection 
  * @return boolean true if all went well otherwise false 
  */ 
   
  public boolean setConnection(Connection theConnection) 
    { 
    boolean returnCode = true; 
    
    theLog.debug("CustomersMgr - Attempting to set connection");
    try 
      { 
      // We need to keep a copy of the connection in case an object which
      // is currently null is instantiated later
      this.theConnection = theConnection;
      
      if (theCustomersIns != null)
        { 
        theCustomersIns.setConnection(theConnection); 
        } 
      
      if (CustomersUpd != null)
        { 
        CustomersUpd.setConnection(theConnection); 
        } 
      
      if (theCustomersDel != null)
        { 
        theCustomersDel.setConnection(theConnection); 
        } 
      
      if (theBookingsBkgCst != null)
        { 
        theBookingsBkgCst.setConnection(theConnection); 
        } 
      
      if (theCustomersCstPkLck != null)
        { 
        theCustomersCstPkLck.setConnection(theConnection); 
        } 
      
      if (theCustomersCstPk != null)
        { 
        theCustomersCstPk.setConnection(theConnection); 
        } 
      
      if (theCustomersCstIx1 != null)
        { 
        theCustomersCstIx1.setConnection(theConnection); 
        } 
      } 
    catch (Exception e) 
      { 
      theLog.warning(e.toString()); 
      returnCode = false; 
      } 
    
    
    return(returnCode); 
    } 
  
} // Generated by JDBCWizard 6.0.2814  
